{"remainingRequest":"/home/nebojsa/projects/factory-academy-ts/node_modules/babel-loader/lib/index.js!/home/nebojsa/projects/factory-academy-ts/node_modules/ts-loader/index.js??ref--13-2!/home/nebojsa/projects/factory-academy-ts/src/router/router.service.ts","dependencies":[{"path":"/home/nebojsa/projects/factory-academy-ts/src/router/router.service.ts","mtime":1625834850566},{"path":"/home/nebojsa/projects/factory-academy-ts/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/nebojsa/projects/factory-academy-ts/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/nebojsa/projects/factory-academy-ts/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvaG9tZS9uZWJvanNhL3Byb2plY3RzL2ZhY3RvcnktYWNhZGVteS10cy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9ob21lL25lYm9qc2EvcHJvamVjdHMvZmFjdG9yeS1hY2FkZW15LXRzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzLmpzIjsKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgeyBUT0tFTl9MU19OQU1FIH0gZnJvbSAiQC9jb25zdGFudHMvY29uc3RhbnRzIjsKaW1wb3J0IHN0b3JlIGZyb20gJ0Avc3RvcmUnOwppbXBvcnQgYXV0aE1vZHVsZSBmcm9tICdAL3N0b3JlL21vZHVsZXMvYXV0aC9hdXRoTW9kdWxlJzsKCnZhciBSb3V0ZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFJvdXRlcigpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSb3V0ZXIpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFJvdXRlciwgW3sKICAgIGtleTogInJvdXRlckd1YXJkcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcm91dGVyR3VhcmRzKHRvLCBmcm9tLCBuZXh0KSB7CiAgICAgIHZhciB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFRPS0VOX0xTX05BTUUpOyAvLyBzdG9yZS5kaXNwYXRjaCgnYXV0aFN0b3JlL2ZldGNoQWN0aXZlQWNjb3VudCcpCgogICAgICBhdXRoTW9kdWxlLmZldGNoQWN0aXZlQWNjb3VudCgpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIHZhciByb2xlID0gcmVzLmRhdGEucm9sZTsKICAgICAgICBWdWUucHJvdG90eXBlLiRyb2xlID0gcmVzLmRhdGEucm9sZTsKICAgICAgICBzdG9yZS5jb21taXQoJ2F1dGhTdG9yZS9zZXRTdGF0ZScsIHsKICAgICAgICAgIHByb3A6ICdsb2dnZWRVc2VyJywKICAgICAgICAgIHZhbHVlOiByZXMuZGF0YQogICAgICAgIH0pOwoKICAgICAgICBpZiAoIXRva2VuKSB7CiAgICAgICAgICBuZXh0KCIvbG9naW4iKTsKICAgICAgICB9CgogICAgICAgIGlmICh0b2tlbiAmJiByb2xlICYmIHRvLm1ldGEuYWxsb3dlZFJvbGVzLmluY2x1ZGVzKHJvbGUpKSB7CiAgICAgICAgICBuZXh0KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICghdG9rZW4pIHsKICAgICAgICAgICAgbmV4dCgiL2xvZ2luIik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAocm9sZSAmJiByb2xlID09PSAndGVhY2hlcicgJiYgdG8ucGF0aCA9PT0gJy8nKSB7CiAgICAgICAgICAgICAgbmV4dCh7CiAgICAgICAgICAgICAgICBuYW1lOiAncHJvZmVzc29yLWhvbWUnCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbmV4dCh7CiAgICAgICAgICAgICAgICBuYW1lOiAiZXJyb3IiCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uICgpIHsKICAgICAgICBuZXh0KCIvbG9naW4iKTsKICAgICAgfSk7IC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAvLyBpZih0b2tlbiAmJiB0by5tZXRhLmFsbG93ZWRSb2xlcy5pbmNsdWRlcyh0b2tlbi5yb2xlKSkgewogICAgICAvLyAJbmV4dCgpOwogICAgICAvLyB9IGVsc2UgewogICAgICAvLyAJaWYoIXRva2VuKSB7CiAgICAgIC8vIAkJbmV4dCgiL2xvZ2luIik7CiAgICAgIC8vIAl9IGVsc2UgewogICAgICAvLyAJCWlmICh0b2tlbiAmJiB0b2tlbi5yb2xlID09PSAncHJvZmVzc29yJyAmJiB0by5wYXRoID09PSAnLycpIHsKICAgICAgLy8gCQkJbmV4dCh7IG5hbWU6ICdwcm9mZXNzb3ItaG9tZScgfSk7CiAgICAgIC8vIAkJfSBlbHNlIHsKICAgICAgLy8gCQkJbmV4dCh7IG5hbWU6ICJlcnJvciIgfSk7CiAgICAgIC8vIAkJfQogICAgICAvLyAJfQogICAgICAvLyB9CiAgICB9CiAgfV0pOwoKICByZXR1cm4gUm91dGVyOwp9KCk7CgpleHBvcnQgdmFyIHJvdXRlclNlcnZpY2UgPSBuZXcgUm91dGVyKCk7"},{"version":3,"sources":["/home/nebojsa/projects/factory-academy-ts/src/router/router.service.ts"],"names":[],"mappings":";;;;AAAA,OAAO,GAAP,MAAgB,KAAhB;AACA,SAAS,aAAT,QAA8B,uBAA9B;AACA,OAAO,KAAP,MAAkB,SAAlB;AACA,OAAO,UAAP,MAAuB,iCAAvB;;IAEM,M;;;;;;;WACL,sBAAa,EAAb,EAAsB,IAAtB,EAAiC,IAAjC,EAA0C;AACzC,UAAM,KAAK,GAAG,YAAY,CAAC,OAAb,CAAqB,aAArB,CAAd,CADyC,CAEzC;;AACM,MAAA,UAAU,CAAC,kBAAX,GACL,IADK,CACA,UAAC,GAAD,EAAQ;AACb,YAAM,IAAI,GAAG,GAAG,CAAC,IAAJ,CAAS,IAAtB;AACA,QAAA,GAAG,CAAC,SAAJ,CAAc,KAAd,GAAsB,GAAG,CAAC,IAAJ,CAAS,IAA/B;AACA,QAAA,KAAK,CAAC,MAAN,CAAa,oBAAb,EAAmC;AAClC,UAAA,IAAI,EAAE,YAD4B;AAElC,UAAA,KAAK,EAAE,GAAG,CAAC;AAFuB,SAAnC;;AAIA,YAAI,CAAC,KAAL,EAAY;AACX,UAAA,IAAI,CAAC,QAAD,CAAJ;AACA;;AACD,YAAG,KAAK,IAAI,IAAT,IAAiB,EAAE,CAAC,IAAH,CAAQ,YAAR,CAAqB,QAArB,CAA8B,IAA9B,CAApB,EAAyD;AACxD,UAAA,IAAI;AACJ,SAFD,MAEO;AACN,cAAG,CAAC,KAAJ,EAAW;AACV,YAAA,IAAI,CAAC,QAAD,CAAJ;AACA,WAFD,MAEO;AACN,gBAAG,IAAI,IAAI,IAAI,KAAK,SAAjB,IAA8B,EAAE,CAAC,IAAH,KAAY,GAA7C,EAAkD;AACjD,cAAA,IAAI,CAAC;AAAE,gBAAA,IAAI,EAAE;AAAR,eAAD,CAAJ;AACA,aAFD,MAEO;AACN,cAAA,IAAI,CAAC;AAAE,gBAAA,IAAI,EAAE;AAAR,eAAD,CAAJ;AACA;AACD;AACD;AACD,OAxBK,WAyBC,YAAK;AACX,QAAA,IAAI,CAAC,QAAD,CAAJ;AACA,OA3BK,EAHmC,CAiCnC;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;;;;;;AAEF,OAAO,IAAM,aAAa,GAAG,IAAI,MAAJ,EAAtB","sourcesContent":["import Vue from 'vue';\nimport { TOKEN_LS_NAME } from \"@/constants/constants\";\nimport store from '@/store'\nimport authModule from '@/store/modules/auth/authModule';\n\nclass Router {\n\trouterGuards(to: any, from: any, next: any) {\n\t\tconst token = localStorage.getItem(TOKEN_LS_NAME);\n\t\t// store.dispatch('authStore/fetchActiveAccount')\n        authModule.fetchActiveAccount()\n\t\t.then((res) => {\n\t\t\tconst role = res.data.role;\n\t\t\tVue.prototype.$role = res.data.role;\n\t\t\tstore.commit('authStore/setState', {\n\t\t\t\tprop: 'loggedUser',\n\t\t\t\tvalue: res.data\n\t\t\t});\n\t\t\tif (!token) {\n\t\t\t\tnext(\"/login\");\n\t\t\t}\n\t\t\tif(token && role && to.meta.allowedRoles.includes(role)) {\n\t\t\t\tnext();\n\t\t\t} else {\n\t\t\t\tif(!token) {\n\t\t\t\t\tnext(\"/login\");\n\t\t\t\t} else {\n\t\t\t\t\tif(role && role === 'teacher' && to.path === '/') {\n\t\t\t\t\t\tnext({ name: 'professor-home' });\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnext({ name: \"error\" });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t\t.catch(() => {\n\t\t\tnext(\"/login\");\n\t\t})\n\n\n        //----------------------------------------------------------------\n\t\t// if(token && to.meta.allowedRoles.includes(token.role)) {\n\t\t// \tnext();\n\t\t// } else {\n\t\t// \tif(!token) {\n\t\t// \t\tnext(\"/login\");\n\t\t// \t} else {\n\t\t// \t\tif (token && token.role === 'professor' && to.path === '/') {\n\t\t// \t\t\tnext({ name: 'professor-home' });\n\t\t// \t\t} else {\n\t\t// \t\t\tnext({ name: \"error\" });\n\t\t// \t\t}\n\t\t// \t}\n\t\t// }\n\n\n\t}\n}\nexport const routerService = new Router();\n"],"sourceRoot":""}]}